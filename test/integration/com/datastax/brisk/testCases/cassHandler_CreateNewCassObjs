DROP TABLE IF EXISTS fresh_cf;
DROP TABLE IF EXISTS fresh_cf_ext;

CREATE TABLE fresh_cf (foo INT, bar STRING);

LOAD DATA LOCAL INPATH '[[EXAMPLES]]/kv1.txt' OVERWRITE INTO TABLE fresh_cf;

CREATE EXTERNAL TABLE fresh_cf_ext (foo INT, bar STRING)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES (
    "cassandra.ks.name" = "fresh_ks",
    "cassandra.cf.name" = "fresh_cf_ext" );

INSERT OVERWRITE TABLE fresh_cf_ext select foo, bar from fresh_cf;

SHOW TABLES;
SELECT foo, bar from fresh_cf_ext;
SELECT count(*) from fresh_cf_ext;
SELECT max(foo), min(foo), sum(foo), count(*) from fresh_cf_ext;
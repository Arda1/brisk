hive> DROP TABLE IF EXISTS alter_test_table;
hive> DROP TABLE IF EXISTS alter_test_table_ctas;
hive> DROP TABLE IF EXISTS alter_test_table_renamed;
hive> CREATE TABLE alter_test_table (foo INT, bar STRING) COMMENT 'table to test DDL ops' PARTITIONED BY (ds STRING) STORED AS TEXTFILE;
hive> LOAD DATA LOCAL INPATH '[[EXAMPLES]]/kv1.txt' OVERWRITE INTO TABLE alter_test_table PARTITION (ds='2008-08-08');
Copying file: file:[[EXAMPLES]]/kv1.txt
hive> CREATE TABLE alter_test_table_ctas as SELECT * FROM alter_test_table;
hive> DESCRIBE alter_test_table_ctas;
foo	int	
bar	string	
ds	string	
hive> ALTER TABLE alter_test_table ADD COLUMNS (new_col1 INT);
hive> INSERT OVERWRITE TABLE alter_test_table PARTITION (ds='2008-08-15') SELECT foo, bar, 333333333 FROM alter_test_table_ctas WHERE ds='2008-08-08';
hive> ALTER TABLE alter_test_table ADD COLUMNS (new_col2 STRING, new_col3 STRING COMMENT 'a comment');
hive> INSERT OVERWRITE TABLE alter_test_table PARTITION (ds='2008-08-18') SELECT foo, bar, 12345678, 'new string to insert', '2011-05-07' FROM alter_test_table WHERE ds='2008-08-18';
hive> ALTER TABLE alter_test_table CHANGE new_col1 new_col1a STRING after new_col2;
hive> ALTER TABLE alter_test_table CHANGE bar bar STRING FIRST;
hive> ALTER TABLE alter_test_table CHANGE foo foo INT FIRST;
hive> LOAD DATA LOCAL INPATH '[[EXAMPLES]]/kv3.txt' OVERWRITE INTO TABLE alter_test_table PARTITION (ds='2008-08-22');
Copying file: file:[[EXAMPLES]]/kv3.txt
hive> SHOW PARTITIONS alter_test_table;
cfs://null/user/hive/warehouse/alter_test_table/ds=2008-08-08
cfs://null/user/hive/warehouse/alter_test_table/ds=2008-08-15
cfs://null/user/hive/warehouse/alter_test_table/ds=2008-08-18
cfs://null/user/hive/warehouse/alter_test_table/ds=2008-08-22
hive> DESCRIBE alter_test_table;
foo	int	
bar	string	
new_col2	string	
new_col1a	string	
new_col3	string	a comment
ds	string	
hive> SELECT count(*), ds FROM alter_test_table GROUP BY ds;
500	2008-08-08
500	2008-08-15
25	2008-08-22
hive> ALTER TABLE alter_test_table RENAME TO alter_test_table_renamed;
hive> LOAD DATA LOCAL INPATH '[[EXAMPLES]]/kv3.txt' OVERWRITE INTO TABLE alter_test_table_renamed PARTITION (ds='2008-08-22');
Copying file: file:[[EXAMPLES]]/kv3.txt
Deleted cfs://null/user/hive/warehouse/alter_test_table_renamed/ds=2008-08-22
hive> ALTER TABLE alter_test_table_renamed ADD COLUMNS (new_col_after_rename INT COMMENT 'a comment');
hive> ALTER TABLE alter_test_table_renamed replace columns (foo2 INT, bar2 STRING);
hive> ALTER TABLE alter_test_table_renamed change foo2 foo3 INT;
hive> ALTER TABLE alter_test_table_renamed change bar2 bar3 STRING FIRST;
hive> LOAD DATA LOCAL INPATH '[[EXAMPLES]]/kv3.txt' OVERWRITE INTO TABLE alter_test_table_renamed PARTITION (ds='2008-08-08');
Copying file: file:[[EXAMPLES]]/kv3.txt
Deleted cfs://null/user/hive/warehouse/alter_test_table_renamed/ds=2008-08-08
hive> ALTER TABLE alter_test_table_renamed TOUCH;
hive> ALTER TABLE alter_test_table_renamed TOUCH PARTITION (ds='2008-08-08');
hive> ALTER TABLE alter_test_table_renamed TOUCH PARTITION (ds='2008-08-15');
hive> SHOW PARTITIONS alter_test_table_renamed;
cfs://null/user/hive/warehouse/alter_test_table_renamed/ds=2008-08-08
cfs://null/user/hive/warehouse/alter_test_table_renamed/ds=2008-08-15
cfs://null/user/hive/warehouse/alter_test_table_renamed/ds=2008-08-18
cfs://null/user/hive/warehouse/alter_test_table_renamed/ds=2008-08-22
hive> DESCRIBE alter_test_table_renamed;
bar3	string	
foo3	int	
ds	string	
hive> SELECT ds, COUNT(*) FROM alter_test_table_renamed GROUP BY ds;
2008-08-08	25
2008-08-15	500
2008-08-22	25
hive> DROP TABLE alter_test_table_renamed;
hive> DROP TABLE alter_test_table_ctas;
hive> quit;

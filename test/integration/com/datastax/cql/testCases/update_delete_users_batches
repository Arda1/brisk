use cqldb;

TRUNCATE users;

INSERT INTO users (KEY, password) VALUES ('user1', 'ch@ngem3a');
UPDATE users SET gender = 'm', birth_year = '1980' WHERE KEY = 'user1';
SELECT * FROM users WHERE key='user0';

TRUNCATE users;
SELECT * FROM users WHERE key='user0';

INSERT INTO users (KEY, password) VALUES ('user1', 'ch@ngem3a');
INSERT INTO users (KEY, password) VALUES ('user1', 'ch@ngem3a');
INSERT INTO users (KEY, password) VALUES ('user1', 'ch@ngem3a');
INSERT INTO users (KEY, password, gender, state, birth_year) VALUES ('user1', 'ch@ngem3', 'f', 'TX', '1968');
INSERT INTO users (KEY, password) VALUES ('user0', 'ch@ngem3');	

SELECT * FROM users WHERE key='user0';
truncate users;	
SELECT * FROM users;


DROP INDEX gender_key ON users (gender);
DROP INDEX state_key ON users (state);
DROP INDEX birth_year_key ON users (birth_year);

BEGIN BATCH
INSERT INTO users (KEY, password) VALUES ('user2', 'ch@ngem3b');
INSERT INTO users (KEY, password) VALUES ('user3', 'ch@ngem3c');
INSERT INTO users (KEY, password) VALUES ('user4', 'ch@ngem3d');
INSERT INTO users (KEY, password) VALUES ('user5', 'ch@ngem3e');
APPLY BATCH

BEGIN BATCH
INSERT INTO users (KEY, password) VALUES ('user6', 'ch@ngem3f');
INSERT INTO users (KEY, password) VALUES ('user7', 'ch@ngem3g');
INSERT INTO users (KEY, password) VALUES ('user8', 'ch@ngem3h');
INSERT INTO users (KEY, password) VALUES ('user9', 'ch@ngem3i');
APPLY BATCH


CREATE INDEX gender_key ON users (gender);
CREATE INDEX state_key ON users (state);
CREATE INDEX birth_year_key ON users (birth_year);

INSERT INTO users (KEY, password) VALUES ('user10', 'ch@ngem3c');
INSERT INTO users (KEY, password) VALUES ('user11', 'ch@ngem3d');
INSERT INTO users (KEY, password) VALUES ('user12', 'ch@ngem3e');
INSERT INTO users (KEY, password) VALUES ('user13', 'ch@ngem3f');
INSERT INTO users (KEY, password) VALUES ('user14', 'ch@ngem3g');
INSERT INTO users (KEY, password) VALUES ('user15', 'ch@ngem3h');
INSERT INTO users (KEY, password) VALUES ('user16', 'ch@ngem3i');


UPDATE users SET gender = 'm', birth_year = '1980' WHERE KEY = 'user1';

BEGIN BATCH
UPDATE users SET 'gender' = 'f', birth_year = '1972' WHERE KEY = 'user2';
UPDATE users SET 'gender' = 'm', birth_year = '1977' WHERE KEY = 'user3';
APPLY BATCH

BEGIN BATCH USING CONSISTENCY ONE
UPDATE users SET gender = 'f', birth_year = '1972', state = 'TX' WHERE KEY = 'user4';
UPDATE users SET gender = 'f', birth_year = '1972', state = 'TX' WHERE KEY = 'user5';
APPLY BATCH	

BEGIN BATCH USING CONSISTENCY QUORUM
UPDATE users SET gender = 'f', birth_year = '1972', state = 'TX' WHERE KEY = 'user5';
UPDATE users SET gender = 'f', birth_year = '1972', state = 'TX' WHERE KEY = 'user6';
APPLY BATCH	

BEGIN BATCH USING CONSISTENCY ALL
UPDATE users SET gender = 'f', birth_year = '1972', state = 'TX' WHERE KEY = 'user7';
UPDATE users SET gender = 'f', birth_year = '1972', state = 'TX' WHERE KEY = 'user8';
APPLY BATCH	

SELECT * FROM users WHERE KEY='user1';	

DELETE state FROM users WHERE KEY = 'user2';
SELECT * FROM users WHERE KEY='user2';
UPDATE users SET state = 'TX' WHERE KEY = 'user2';
SELECT * FROM users WHERE KEY='user2';

DELETE FROM users WHERE KEY = 'user2';

INSERT INTO users (KEY, password, gender, state, birth_year) VALUES ('user2', 'ch@ngem3b', 'm', 'CA', '1966');	

UPDATE users SET state = 'FL' WHERE KEY = 'user2';	

DELETE FROM users WHERE KEY in ('user3', 'user2');

UPDATE users SET gender = 'm', state = 'TX' WHERE KEY = 'user4';

DELETE FROM users USING CONSISTENCY ONE WHERE KEY = 'user5';

DELETE FROM users USING CONSISTENCY QUORUM WHERE KEY = 'user6';

DELETE FROM users USING CONSISTENCY ALL WHERE KEY = 'user7' ;

SELECT * FROM users;
